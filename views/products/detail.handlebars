<article class="product-detail">
  <div class="product-media">
    <div class="gallery slideshow" data-slideshow>
      <div class="slideshow-main">
        <button type="button" class="slideshow-arrow slideshow-prev" data-slide="prev" aria-label="·∫¢nh tr∆∞·ªõc">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 18l-6-6 6-6"/></svg>
        </button>
        <div class="slideshow-viewport">
          {{#each product.images}}
          <img class="slideshow-slide{{#if @first}} is-active{{/if}}" src="{{this}}" alt="{{../product.title}}" data-index="{{@index}}" />
          {{/each}}
        </div>
        <button type="button" class="slideshow-arrow slideshow-next" data-slide="next" aria-label="·∫¢nh ti·∫øp">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg>
        </button>
      </div>
      <div class="slideshow-indicators">
        {{#each product.images}}
        <button type="button" class="slideshow-dot{{#if @first}} is-active{{/if}}" data-goto="{{@index}}" aria-label="Xem ·∫£nh {{add @index 1}}"></button>
        {{/each}}
      </div>
      <div class="thumbs">
        {{#each product.images}}
        <img src="{{this}}" alt="{{../product.title}} thumbnail" class="{{#if @first}}is-active{{/if}}" data-thumb="{{@index}}" />
        {{/each}}
      </div>
    </div>

    <section class="media-tabs" data-product-tabs>
      <div class="media-tabs__nav" role="tablist">
        <button
          type="button"
          class="media-tab is-active"
          data-tab="seller"
          role="tab"
          aria-selected="true"
        >
          Th√¥ng tin ng∆∞·ªùi b√°n
        </button>
        <button
          type="button"
          class="media-tab"
          data-tab="shipping"
          role="tab"
          aria-selected="false"
        >
          V·∫≠n chuy·ªÉn & thanh to√°n
        </button>
      </div>

      <div class="media-tabs__panel is-active" data-tab-panel="seller" role="tabpanel">
        <h3>Ng∆∞·ªùi b√°n: 
          {{#if isSellerOfProduct}}
            {{product.seller.name}} (B·∫°n)
          {{else}}
            <a href="/users/{{product.seller.id}}/ratings" class="seller-profile-link">{{product.seller.name}}</a>
          {{/if}}
        </h3>
        <ul>
          <li>ƒê√°nh gi√°: 
            {{#unless isSellerOfProduct}}
              <a href="/users/{{product.seller.id}}/ratings">
            {{/unless}}
            {{product.seller.ratingPlus}} üëç / {{product.seller.ratingMinus}} üëé ({{product.seller.ratingScore}}%)
            {{#unless isSellerOfProduct}}
              </a>
            {{/unless}}
          </li>
          <li>Ph·∫£n h·ªìi trong: {{product.seller.responseTime}}</li>
          <li>Huy hi·ªáu: {{#each product.seller.badges}}<span class="badge">{{this}}</span>{{/each}}</li>
        </ul>
      </div>

      <div class="media-tabs__panel" data-tab-panel="shipping" role="tabpanel" hidden>
        <h3>V·∫≠n chuy·ªÉn & thanh to√°n</h3>
        <p><strong>Giao h√†ng:</strong> {{#each product.shippingOptions}}<span>{{this}}</span>{{#unless @last}},
          {{/unless}}{{/each}}</p>
        <p><strong>Thanh to√°n:</strong> {{#each product.paymentMethods}}<span>{{this}}</span>{{#unless @last}},
          {{/unless}}{{/each}}</p>
        <p><strong>Ng√†y ƒëƒÉng:</strong> {{formatDate product.startDate}} ({{relativeTime product.startDate}})</p>
      </div>
    </section>
  </div>
  <div class="info">
    <h1>{{product.title}}</h1>
    {{#if product.summary}}
    <p class="product-summary">{{product.summary}}</p>
    {{/if}}
    <div class="price-block">
      <span class="price-current">{{formatCurrency product.currentPrice}}</span>
      {{#if product.buyNowPrice}}
      <span class="price-buy">Mua ngay {{formatCurrency product.buyNowPrice}}</span>
      {{/if}}
    </div>
    <dl class="summary">
      <div>
        <dt>Ng∆∞·ªùi ƒëang d·∫´n</dt>
        <dd data-bid-leader>{{maskName product.highestBidder.name}} ({{percent product.highestBidder.ratingPlus (add
          product.highestBidder.ratingPlus product.highestBidder.ratingMinus)}})</dd>
      </div>
      <div>
        <dt>L∆∞·ª£t ra gi√°</dt>
        <dd data-bid-count>{{product.bidCount}}</dd>
      </div>
      <div>
        <dt>Y√™u th√≠ch</dt>
        <dd>{{product.watchers}}</dd>
      </div>
    </dl>

    <div class="time-left" data-enddate="{{product.endDate}}">
      {{#if auctionClosed}}
        Phi√™n ƒë·∫•u gi√° ƒë√£ k·∫øt th√∫c{{#if product.endDate}} ({{formatDate product.endDate}}){{/if}}
      {{else}}
        Th·ªùi gian c√≤n l·∫°i: <span class="countdown">--:--:--</span>
      {{/if}}
    </div>

    {{#if buyNowContext}}
    <section class="buy-now-offer" aria-labelledby="buy-now-offer-title">
      <div class="buy-now-offer__info">
        <p id="buy-now-offer-title" class="buy-now-offer__label">Ch·ªët gi√° ngay</p>
        <strong class="buy-now-offer__price">{{buyNowContext.priceFormatted}}</strong>
        <small>Ng·ª´ng ƒë·∫•u gi√° ngay khi b·∫°n x√°c nh·∫≠n Mua ngay.</small>
      </div>
      <div class="buy-now-offer__actions">
        {{#if buyNowContext.canBuy}}
        <button
          type="button"
          class="btn primary btn-pill buy-now-offer__button"
          data-buy-now
          data-product-id="{{product.id}}"
          data-buy-price="{{buyNowContext.price}}"
        >Mua ngay</button>
        <p class="buy-now-offer__note">Ng∆∞·ªùi ƒë·∫ßu ti√™n ch·ªçn Mua ngay s·∫Ω th·∫Øng s·∫£n ph·∫©m v√† ƒë∆∞·ª£c chuy·ªÉn t·ªõi b∆∞·ªõc thanh to√°n.</p>
        {{else if buyNowContext.requiresLogin}}
        <a class="btn secondary btn-pill buy-now-offer__button" href="{{buyNowContext.loginUrl}}">ƒêƒÉng nh·∫≠p ƒë·ªÉ Mua
          ngay</a>
        {{#if buyNowContext.note}}
        <p class="buy-now-offer__note">{{buyNowContext.note}}</p>
        {{/if}}
        {{else}}
        <button type="button" class="btn btn-pill buy-now-offer__button" disabled>{{buyNowContext.disabledLabel}}</button>
        {{#if buyNowContext.note}}
        <p class="buy-now-offer__note">{{buyNowContext.note}}</p>
        {{/if}}
        {{/if}}
      </div>
    </section>
    {{/if}}

    {{#if auctionClosed}}
    <div class="auction-status-banner" role="status">
      <strong>Kh√¥ng th·ªÉ ti·∫øp t·ª•c ƒë·∫∑t gi√°</strong>
      <p>
        {{#if (eq auctionClosedReason 'time')}}S·∫£n ph·∫©m ƒë√£ h·∫øt th·ªùi gian ƒë·∫•u gi√°.{{else}}Phi√™n ƒë·∫•u gi√° ƒë√£ ƒë∆∞·ª£c ng∆∞·ªùi b√°n ƒë√≥ng l·∫°i.{{/if}}
      </p>
    </div>
    {{/if}}

    {{#if bidContext}}
    <section class="bidding-panel" aria-labelledby="bidding-panel-title">
      <div class="bid-panel-header">
        <h2 id="bidding-panel-title">ƒê·∫∑t gi√°</h2>
        <p>Gi√° g·ª£i √Ω ƒë∆∞·ª£c t√≠nh b·∫±ng gi√° hi·ªán t·∫°i c·ªông v·ªõi b∆∞·ªõc gi√° ng∆∞·ªùi b√°n thi·∫øt l·∫≠p.</p>
      </div>

      <div class="bid-price-grid">
        <article class="bid-price-card">
          <span>Gi√° hi·ªán t·∫°i</span>
          <strong data-current-price>{{#if bidContext.currentPrice}}{{formatCurrency bidContext.currentPrice}}{{else}}‚Äî{{/if}}</strong>
        </article>
        <article class="bid-price-card">
          <span>Gi√° g·ª£i √Ω</span>
          <strong data-suggested-price>{{#if bidContext.suggestedBid}}{{formatCurrency bidContext.suggestedBid}}{{else}}‚Äî{{/if}}</strong>
          {{#if bidContext.bidStep}}
          <small>B∆∞·ªõc gi√° t·ªëi thi·ªÉu {{formatCurrency bidContext.bidStep}}</small>
          {{/if}}
        </article>
      </div>

      <div class="bid-entry">
        <label for="bid-amount-{{product.id}}">Nh·∫≠p gi√° b·∫°n mu·ªën ƒë·∫∑t</label>
        <div class="bid-entry-control">
          <button
            type="button"
            class="bid-step-btn bid-step-btn--decrease"
            data-bid-decrease
            {{#unless bidContext.canBid}}disabled{{/unless}}
            aria-label="Gi·∫£m gi√°"
          >
            <i class="bi bi-dash-lg"></i>
          </button>
          <span>‚Ç´</span>
          <input
            id="bid-amount-{{product.id}}"
            type="text"
            name="bidAmount"
            inputmode="numeric"
            pattern="[0-9]*"
            {{#if bidContext.suggestedBid}}value="{{bidContext.suggestedBid}}" data-initial-value="{{bidContext.suggestedBid}}"{{/if}}
            {{#if bidContext.nextMinimumBid}}data-min-bid="{{bidContext.nextMinimumBid}}"{{/if}}
            {{#if bidContext.bidStep}}data-bid-step="{{bidContext.bidStep}}"{{/if}}
            data-base-amount="{{bidContext.bidBase}}"
            {{#unless bidContext.canBid}}disabled{{/unless}}
            data-bid-input
          />
          <button
            type="button"
            class="bid-step-btn bid-step-btn--increase"
            data-bid-increase
            {{#unless bidContext.canBid}}disabled{{/unless}}
            aria-label="TƒÉng gi√°"
          >
            <i class="bi bi-plus-lg"></i>
          </button>
        </div>
      </div>

      <div class="bid-notices">
        {{#if bidContext.requiresLogin}}
          <p class="bid-notice bid-notice--muted">ƒêƒÉng nh·∫≠p ƒë·ªÉ tham gia ƒë·∫•u gi√° v√† theo d√µi s·∫£n ph·∫©m.</p>
        {{/if}}
        {{#if bidContext.showRatingNotice}}
          <p class="bid-notice bid-notice--warning">{{bidContext.ratingRuleMessage}}</p>
        {{/if}}
        {{#if bidContext.needsApproval}}
          {{#if (eq bidContext.approvalStatus 'approved')}}
            <p class="bid-notice bid-notice--success">Ng∆∞·ªùi b√°n ƒë√£ ch·∫•p thu·∫≠n y√™u c·∫ßu c·ªßa b·∫°n. B·∫°n c√≥ th·ªÉ ƒë·∫∑t gi√° ngay b√¢y gi·ªù.</p>
          {{else if bidContext.pendingApproval}}
            <p class="bid-notice bid-notice--info">Y√™u c·∫ßu c·ªßa b·∫°n ƒëang ch·ªù ng∆∞·ªùi b√°n ph√™ duy·ªát. H√£y quay l·∫°i sau √≠t ph√∫t.</p>
          {{else if bidContext.approvalDenied}}
            <p class="bid-notice bid-notice--warning">Y√™u c·∫ßu tr∆∞·ªõc ƒë√≥ b·ªã t·ª´ ch·ªëi. B·∫°n c√≥ th·ªÉ g·ª≠i l·∫°i v·ªõi l·ªùi nh·∫Øn thuy·∫øt ph·ª•c h∆°n.</p>
          {{else}}
            <p class="bid-notice bid-notice--muted">B·∫°n ch∆∞a c√≥ ƒë√°nh gi√° n√†o n√™n c·∫ßn xin ph√©p ng∆∞·ªùi b√°n tr∆∞·ªõc khi ƒë·∫∑t gi√°.</p>
          {{/if}}
        {{/if}}
        {{#if bidContext.ratingPercent}}
          <p class="bid-notice bid-notice--meta">ƒêi·ªÉm hi·ªán t·∫°i: {{bidContext.ratingPercent}}% ({{bidContext.ratingPlus}} / {{add bidContext.ratingPlus bidContext.ratingMinus}} l·∫ßn ƒë√°nh gi√°)</p>
        {{/if}}
      </div>

      {{#if bidContext.needsApproval}}
        {{#unless (eq bidContext.approvalStatus 'approved')}}
        <div class="bid-request-box" data-bid-request-panel>
          {{#if bidContext.canRequestApproval}}
            <label for="bid-request-note-{{product.id}}">G·ª≠i l·ªùi nh·∫Øn cho ng∆∞·ªùi b√°n (tu·ª≥ ch·ªçn)</label>
            <textarea id="bid-request-note-{{product.id}}" rows="2" data-bid-request-message placeholder="V√≠ d·ª•: T√¥i th·∫≠t s·ª± quan t√¢m s·∫£n ph·∫©m v√† xin ƒë∆∞·ª£c tham gia ƒë·∫•u gi√°."></textarea>
            <button
              type="button"
              class="btn secondary btn-pill"
              data-bid-request
              data-product-id="{{product.id}}"
            >{{#if bidContext.approvalDenied}}G·ª≠i l·∫°i y√™u c·∫ßu{{else}}G·ª≠i y√™u c·∫ßu tham gia ƒë·∫•u gi√°{{/if}}</button>
          {{else if bidContext.pendingApproval}}
            <p class="bid-notice bid-notice--info">Y√™u c·∫ßu ƒëang ƒë∆∞·ª£c x·ª≠ l√Ω. B·∫°n s·∫Ω nh·∫≠n ƒë∆∞·ª£c th√¥ng b√°o sau khi ng∆∞·ªùi b√°n ph·∫£n h·ªìi.</p>
          {{/if}}
        </div>
        {{/unless}}
      {{/if}}

      <div class="bid-button-row">
        <button
          type="button"
          class="btn primary btn-pill"
          data-bid-trigger
          data-product-id="{{product.id}}"
          {{#if bidContext.suggestedBid}}data-suggested-bid="{{bidContext.suggestedBid}}"{{/if}}
          {{#if bidContext.bidStep}}data-bid-step="{{bidContext.bidStep}}"{{/if}}
          {{#if bidContext.nextMinimumBid}}data-min-bid="{{bidContext.nextMinimumBid}}"{{/if}}
          {{#unless bidContext.canBid}}disabled{{/unless}}
        >
          X√°c nh·∫≠n ƒë·∫∑t gi√°
        </button>
        <button
          type="button"
          class="watchlist-button watchlist-button--group btn-pill{{#if product.isWatching}} is-watching{{/if}}"
          data-product-id="{{product.id}}"
          data-watch-state="{{#if product.isWatching}}watching{{else}}idle{{/if}}"
          aria-pressed="{{#if product.isWatching}}true{{else}}false{{/if}}"
          aria-label="{{#if product.isWatching}}B·ªè l∆∞u {{product.title}}{{else}}L∆∞u {{product.title}} v√†o danh s√°ch y√™u th√≠ch{{/if}}"
        >
          <span class="watchlist-heart" aria-hidden="true">
            <svg viewBox="0 0 24 24" role="presentation" focusable="false">
              <path d="M12 21.35l-1.45-1.32C6 15.36 3 12.28 3 8.5 3 6 5 4 7.5 4c1.74 0 3.41 1 4.5 2.44C13.59 5 15.26 4 17 4c2.5 0 4.5 2 4.5 4.5 0 3.78-3 6.86-7.55 11.54L12 21.35z" />
            </svg>
          </span>
          <span class="watch-count">{{#if product.watchers}}{{product.watchers}}{{else}}0{{/if}}</span>
        </button>
      </div>

      {{!-- Auto-bid Section --}}
      {{#if bidContext.canBid}}
      <div class="auto-bid-section" data-auto-bid-section>
        <div class="auto-bid-toggle">
          <button type="button" class="btn tertiary btn-pill auto-bid-toggle-btn" data-auto-bid-toggle>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
            <span>ƒê·∫•u gi√° t·ª± ƒë·ªông</span>
          </button>
        </div>
        <div class="auto-bid-form" data-auto-bid-form hidden>
          <div class="auto-bid-info">
            <p class="auto-bid-description">H·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông ƒë·∫∑t gi√° thay b·∫°n v·ªõi m·ª©c gi√° v·ª´a ƒë·ªß ƒë·ªÉ th·∫Øng, cho ƒë·∫øn khi ƒë·∫°t gi√° t·ªëi ƒëa.</p>
          </div>
          <div class="auto-bid-input-group">
            <label for="auto-bid-max-price">Gi√° t·ªëi ƒëa c·ªßa b·∫°n</label>
            <div class="auto-bid-input-wrapper">
              <input 
                type="text" 
                id="auto-bid-max-price" 
                class="auto-bid-input"
                data-auto-bid-input
                data-product-id="{{product.id}}"
                {{#if bidContext.nextMinimumBid}}data-min-bid="{{bidContext.nextMinimumBid}}"{{/if}}
                {{#if bidContext.bidStep}}data-bid-step="{{bidContext.bidStep}}"{{/if}}
                placeholder="Nh·∫≠p gi√° t·ªëi ƒëa"
                inputmode="numeric"
              />
              <span class="auto-bid-currency">‚Ç´</span>
            </div>
            <p class="auto-bid-hint">T·ªëi thi·ªÉu: <span data-auto-bid-min>{{formatCurrency bidContext.nextMinimumBid}}</span></p>
          </div>
          <div class="auto-bid-status" data-auto-bid-status hidden>
            <span class="auto-bid-status-icon">‚úì</span>
            <span class="auto-bid-status-text">ƒê·∫•u gi√° t·ª± ƒë·ªông ƒëang ho·∫°t ƒë·ªông v·ªõi gi√° t·ªëi ƒëa: <strong data-auto-bid-current-max>‚Äî</strong></span>
          </div>
          <div class="auto-bid-actions">
            <button type="button" class="btn primary btn-pill" data-auto-bid-submit>K√≠ch ho·∫°t ƒë·∫•u gi√° t·ª± ƒë·ªông</button>
            <button type="button" class="btn tertiary btn-pill" data-auto-bid-cancel hidden>H·ªßy ƒë·∫•u gi√° t·ª± ƒë·ªông</button>
          </div>
        </div>
      </div>
      {{/if}}

    </section>
    {{/if}}

    <div class="actions actions--qa">
      <button class="btn tertiary" type="button" data-scroll-target="#qa-thread">H·ªèi v√† ƒê√°p</button>
    </div>

  </div>
</article>

<div class="bid-confirm-modal" data-bid-modal data-product-id="{{product.id}}" hidden>
  <div class="bid-confirm-modal__overlay" data-modal-overlay data-modal-close></div>
  <div class="bid-confirm-modal__dialog" role="dialog" aria-modal="true" aria-labelledby="bid-modal-title">
    <header class="bid-confirm-modal__header">
      <h3 id="bid-modal-title">X√°c nh·∫≠n ƒë·∫∑t gi√°</h3>
      <button type="button" class="modal-close" data-modal-close aria-label="ƒê√≥ng">&times;</button>
    </header>
    <p>B·∫°n s·∫Øp ƒë·∫∑t gi√° <strong data-bid-amount>‚Äî</strong> cho <em>{{product.title}}</em>.</p>
    <p class="modal-note">H·ªá th·ªëng s·∫Ω ghi nh·∫≠n sau khi b·∫°n x√°c nh·∫≠n. Vui l√≤ng ki·ªÉm tra l·∫°i s·ªë ti·ªÅn.</p>
    <div class="modal-actions">
      <button type="button" class="btn tertiary" data-modal-close>Hu·ª∑</button>
      <button type="button" class="btn primary" data-modal-confirm>ƒê·∫∑t gi√°</button>
    </div>
  </div>
</div>

<section class="product-description">
  <h2>Th√¥ng tin s·∫£n ph·∫©m</h2>
  {{{product.description}}}
  <h3>T√†i li·ªáu ƒë√≠nh k√®m</h3>
  <ul class="documents">
    {{#each product.documents}}
    <li>{{this}}</li>
    {{/each}}
  </ul>
</section>

<section class="bid-history">
  <h2>L·ªãch s·ª≠ ƒë·∫•u gi√°</h2>
  <table>
    <thead>
      <tr style="text-align: left;">
        <th>Th·ªùi ƒëi·ªÉm</th>
        <th>Ng∆∞·ªùi mua</th>
        <th>Gi√°</th>
        {{#if isSellerOfProduct}}
        <th>Thao t√°c</th>
        {{/if}}
      </tr>
    </thead>
    <tbody data-bid-history>
      {{#each product.bids}}
      <tr data-bid-row data-bidder-id="{{bidderId}}" {{#if isRejected}}class="is-rejected"{{/if}}>
        <td>{{formatDate time}}</td>
        <td>
          {{#if ../isSellerOfProduct}}
            <a href="/users/{{bidderId}}/ratings" class="bidder-profile-link" title="Xem ƒë√°nh gi√°">{{maskName userName}}</a>
            <span class="bidder-rating">({{ratingPlus}}üëç/{{ratingMinus}}üëé)</span>
          {{else}}
            {{maskName userName}}
          {{/if}}
          {{#if isRejected}}<span class="badge badge--rejected">ƒê√£ t·ª´ ch·ªëi</span>{{/if}}
        </td>
        <td>{{formatCurrency amount}}</td>
        {{#if ../isSellerOfProduct}}
        <td class="bid-actions">
          {{#if isRejected}}
          <button
            type="button"
            class="btn btn-sm btn-unreject-bidder"
            data-unreject-bidder
            data-product-id="{{../product.id}}"
            data-bidder-id="{{bidderId}}"
            data-bidder-name="{{maskName userName}}"
            title="Ho√†n t√°c t·ª´ ch·ªëi"
          >
            <i class="bi bi-arrow-counterclockwise"></i> Ho√†n t√°c
          </button>
          {{else}}
          <button
            type="button"
            class="btn btn-sm danger btn-reject-bidder"
            data-reject-bidder
            data-product-id="{{../product.id}}"
            data-bidder-id="{{bidderId}}"
            data-bidder-name="{{maskName userName}}"
            title="T·ª´ ch·ªëi ng∆∞·ªùi mua n√†y"
          >
            <i class="bi bi-x-circle"></i> T·ª´ ch·ªëi
          </button>
          {{/if}}
        </td>
        {{/if}}
      </tr>
      {{/each}}
    </tbody>
  </table>
</section>

<section class="qa-section" id="qa-thread">
  <header class="qa-header">
    <div>
      <h2>H·ªèi & ƒë√°p</h2>
    </div>
    {{#if qaStatus.error}}
    <div class="qa-alert qa-alert--error">
      {{#if (eq qaStatus.error 'empty')}}Vui l√≤ng nh·∫≠p n·ªôi dung c√¢u h·ªèi.{{/if}}
      {{#if (eq qaStatus.error 'emptyAnswer')}}Vui l√≤ng nh·∫≠p n·ªôi dung ph·∫£n h·ªìi.{{/if}}
      {{#if (eq qaStatus.error 'owner')}}B·∫°n l√† ng∆∞·ªùi b√°n c·ªßa s·∫£n ph·∫©m n√†y n√™n kh√¥ng th·ªÉ ƒë·∫∑t c√¢u h·ªèi.{{/if}}
      {{#if (eq qaStatus.error 'notSeller')}}Ch·ªâ ng∆∞·ªùi b√°n m·ªõi ƒë∆∞·ª£c tr·∫£ l·ªùi c√¢u h·ªèi.{{/if}}
      {{#if (eq qaStatus.error 'notfound')}}Kh√¥ng t√¨m th·∫•y c√¢u h·ªèi ƒë·ªÉ tr·∫£ l·ªùi.{{/if}}
    </div>
    {{/if}}
    {{#if qaStatus.success}}
    <div class="qa-alert qa-alert--success">
      {{#if (eq qaStatus.success 'question')}}ƒê√£ g·ª≠i c√¢u h·ªèi t·ªõi ng∆∞·ªùi b√°n.{{/if}}
      {{#if (eq qaStatus.success 'answer')}}ƒê√£ g·ª≠i ph·∫£n h·ªìi ƒë·∫øn ng∆∞·ªùi mua.{{/if}}
    </div>
    {{/if}}
  </header>

  <div class="qa-composer">
    {{#if canAskQuestion}}
    <form action="/products/{{product.id}}/questions" method="post" class="qa-form" data-qa-form="question">
      <div class="qa-avatar" aria-hidden="true" data-letter="{{initial currentUser.name}}"></div>
      <div class="qa-form-body">
        <textarea name="question" rows="2" placeholder="H·ªèi ng∆∞·ªùi b√°n v·ªÅ s·∫£n ph·∫©m..."
          required data-auto-resize></textarea>
        <div class="qa-form-actions">
          <button type="submit" class="btn primary">G·ª≠i c√¢u h·ªèi</button>
        </div>
      </div>
    </form>
    {{else if isAuthenticated}}
    {{else}}
    <div class="qa-placeholder">
      <p>ƒêƒÉng nh·∫≠p ƒë·ªÉ tr√≤ chuy·ªán v·ªõi ng∆∞·ªùi b√°n.</p>
      <a class="btn secondary" href="/auth/login?returnUrl=/products/{{product.id}}">ƒêƒÉng nh·∫≠p ngay</a>
    </div>
    {{/if}}
  </div>

  <div class="qa-thread">
    {{#if product.questions.length}}
    {{#each product.questions}}
    <article class="qa-comment" id="comment-{{id}}">
      <div class="qa-avatar" aria-hidden="true" data-letter="{{initial askedBy}}"></div>
      <div class="qa-bubble">
        <div class="qa-meta">
          <strong>{{maskName askedBy}}</strong>
          <span>{{relativeTime askedAt}}</span>
        </div>
        <p class="qa-question">{{question}}</p>
        <div class="qa-actions">
          <span>{{answers.length}} ph·∫£n h·ªìi</span>
          {{#if @root.canAnswerQuestion}}
          <button type="button" class="qa-action-link" data-action="toggle-reply" data-target="reply-{{id}}">Tr·∫£
            l·ªùi</button>
          {{/if}}
        </div>
        <div class="qa-replies">
          {{#if answers.length}}
          {{#each answers}}
          <article class="qa-reply">
            <div class="qa-avatar qa-avatar--small" aria-hidden="true" data-letter="{{initial answeredBy}}"></div>
            <div class="qa-bubble">
              <div class="qa-meta">
                <strong>{{maskName answeredBy}}</strong>
                <span>{{relativeTime answeredAt}}</span>
              </div>
              <p class="qa-answer">{{text}}</p>
            </div>
          </article>
          {{/each}}
          {{else}}
            {{#if @root.canAnswerQuestion}}
            <p class="qa-reply-placeholder">B·∫°n ch∆∞a ph·∫£n h·ªìi c√¢u h·ªèi n√†y.</p>
            {{/if}}
          {{/if}}
        </div>
        {{#if @root.canAnswerQuestion}}
        <form class="qa-reply-form" id="reply-{{id}}" action="/products/{{@root.product.id}}/questions/{{id}}/answers"
          method="post" hidden>
          <textarea name="answer" rows="2" placeholder="G·ª≠i ph·∫£n h·ªìi t·ªõi ng∆∞·ªùi mua..." required data-auto-resize></textarea>
          <div class="qa-form-actions">
            <span>Ph·∫£n h·ªìi s·∫Ω hi·ªÉn th·ªã c√¥ng khai.</span>
            <button type="submit" class="btn primary">G·ª≠i ph·∫£n h·ªìi</button>
          </div>
        </form>
        {{/if}}
      </div>
    </article>
    {{/each}}
    {{else}}
    <div class="qa-placeholder">
      <p>H√£y l√† ng∆∞·ªùi ƒë·∫ßu ti√™n ƒë·∫∑t c√¢u h·ªèi cho s·∫£n ph·∫©m n√†y!</p>
    </div>
    {{/if}}
  </div>
</section>

{{#if relatedProducts.length}}
<section class="related-products">
  <h2>S·∫£n ph·∫©m c√πng danh m·ª•c</h2>
  <div class="product-grid">
    {{#each relatedProducts}}
    {{> product-card}}
    {{/each}}
  </div>
</section>
{{/if}}